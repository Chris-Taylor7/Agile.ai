
<div class="h-full flex flex-col">
  <!-- Toolbar -->
  <div class="mb-6 flex justify-between items-center">
    <div class="flex items-center gap-4 flex-1 max-w-md">
      <div class="relative w-full">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
          </svg>
        </div>
        <input 
          type="text" 
          placeholder="Filter issues..." 
          (input)="onSearch($event)"
          class="block w-full pl-9 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 sm:text-sm transition duration-150 ease-in-out shadow-sm"
        >
      </div>
    </div>
    <button 
      (click)="openCreateModal()"
      class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-sm font-medium text-sm"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
      New Issue
    </button>
  </div>

  <!-- Board Columns -->
  <div class="flex-1 overflow-x-auto overflow-y-hidden">
    <div class="flex gap-6 h-full min-w-[1000px]">
      
      @for (col of columns; track col.id) {
        <div 
          class="flex-1 flex flex-col min-w-[300px] h-full rounded-xl bg-gray-100/50 border border-gray-200/60"
          (dragover)="onDragOver($event)" 
          (dragleave)="onDragLeave($event)"
          (drop)="onDrop($event, col.id)"
        >
          <!-- Column Header -->
          <div class="p-4 flex items-center justify-between border-b border-gray-200/50 bg-white/40 rounded-t-xl backdrop-blur-sm">
            <div class="flex items-center gap-2">
              <span class="font-semibold text-gray-700">{{ col.title }}</span>
              <span class="bg-gray-200 text-gray-600 text-xs px-2 py-0.5 rounded-full font-medium">
                {{ getIssuesForColumn(col.id).length }}
              </span>
            </div>
            <!-- Indicator dot -->
            <div class="w-2 h-2 rounded-full" [class.bg-slate-300]="col.id === 'todo'" [class.bg-blue-400]="col.id === 'inprogress'" [class.bg-green-400]="col.id === 'done'"></div>
          </div>

          <!-- Column Content -->
          <div class="flex-1 p-3 overflow-y-auto custom-scrollbar space-y-3">
            @for (issue of getIssuesForColumn(col.id); track issue.id) {
              <div 
                draggable="true" 
                (dragstart)="onDragStart($event, issue.id)"
                class="transform transition-transform hover:-translate-y-0.5"
              >
                <app-issue-card 
                  [issue]="issue"
                  (edit)="openEditModal($event)"
                ></app-issue-card>
              </div>
            } @empty {
              <div class="h-full flex flex-col items-center justify-center text-gray-400 text-sm border-2 border-dashed border-gray-200 rounded-lg m-2 p-8">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mb-2 opacity-50"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><line x1="12" x2="12" y1="8" y2="16"/><line x1="8" x2="16" y1="12" y2="12"/></svg>
                <span>Drop items here</span>
              </div>
            }
          </div>
        </div>
      }

    </div>
  </div>

  <!-- Modals -->
  <app-issue-modal
    [isOpen]="isModalOpen()"
    [issueToEdit]="selectedIssue()"
    (close)="closeModal()"
    (save)="onSaveIssue($event)"
    (delete)="onDeleteIssue($event)"
  ></app-issue-modal>

</div>
